!function(t){"use strict";var i={};t.badyoo=i,i.registerClass=function(t,e){t.__class=e,i[e]=t};class e{constructor(t,e){this.index=0,this.Uindex=0,this.program=i.current.createProgram(t,e)}bind(){i.current.gl.useProgram(this.program)}AttribLocation(t){this["a_"+this.index++]=i.current.gl.getAttribLocation(this.program,t)}AttriUniformLocation(t){this["u_"+this.Uindex++]=i.current.gl.getUniformLocation(this.program,t)}uploadAttrib(t,e,s,r=!1,a=0,h=0){i.current.gl.enableVertexAttribArray(this["a_"+t]),i.current.gl.vertexAttribPointer(this["a_"+t],e,s,r,a,h)}uploadUniform2f(t,e,s){this["u_"+t]&&i.current.gl.uniform2f(this["u_"+t],e,s)}uploadUniform1f(t,e){this["u_"+t]&&i.current.gl.uniform1f(this["u_"+t],e)}}i.registerClass(class{constructor(){this.debug=!0,this.root=null,this.randerList=[],this.tList=[],this.G_a=this.G_r=this.G_g=this.G_b=0,this.G_m=new r}init(s,r,h,n,o){var l=this;if(l.window=t,l.canvas=o,l.alignC=n,s&&(l.width=s),r&&(l.height=r),null==l.canvas){l.canvas=t.document.createElement("canvas");var u=l.canvas.style;u.position="absolute",u.top=u.left="0px",u.background="#000000",t.document.body.appendChild(l.canvas)}if(l.canvas.width=l.width?l.width:l.width=t.innerWidth,l.canvas.height=l.height?l.height:l.height=t.innerHeight,l.gl=l.canvas.getContext("webgl",{antialias:!1,premultipliedAlpha:!0}),l.gl){console.warn("init w:"+l.width+" h:"+l.height),l.root=null==h?new p:new h,l.root.width=l.width,l.root.height=l.height,i.root=l.root;var d="attribute vec4 a_position;\n            uniform vec2 u_re;\n            varying vec2 v_texCoord;\n            void main() {\n                v_texCoord = a_position.zw;\n                vec2 temp = a_position.xy * u_re"+(0==l.alignC?"-1.0;":";")+"\n                gl_Position = vec4(temp.x,-temp.y,0,1);\n            }";(m=new e(d,"\n            precision mediump float;\n            varying vec2 v_texCoord;\n            uniform sampler2D u_texture;\n            uniform float u_alpha;\n            void main(){\n                gl_FragColor = texture2D(u_texture, v_texCoord)*u_alpha;\n            }")).AttribLocation("a_position"),m.AttriUniformLocation("u_re"),m.AttriUniformLocation("u_alpha"),m.bind();var m,c=2/l.gl.canvas.width,_=2/l.gl.canvas.height;m.uploadUniform2f(0,c,_),l.spriteAProgram=m,(m=new e(d,"\n            precision mediump float;\n            varying vec2 v_texCoord;\n            uniform sampler2D u_texture;\n            void main(){\n                //vec4 temp = texture2D(u_texture, v_texCoord);\n                //float l = 0.299*temp.r+0.587*temp.g+0.114*temp.b;\n                //gl_FragColor = vec4(l,l,l,temp.a);\n                gl_FragColor = texture2D(u_texture, v_texCoord);\n                \n            }")).AttribLocation("a_position"),m.AttriUniformLocation("u_re"),m.bind(),m.uploadUniform2f(0,c,_),l.spriteProgram=m,l.indexBuffer=l.createIndexBuffer(16384),l.posionList=new Float32Array(new ArrayBuffer(1048576));for(var g=0;g<=360;g++){var x=g*Math.PI/180;a.sin[g]=Number(Math.sin(x).toFixed(2)),a.cos[g]=Number(Math.cos(x).toFixed(2))}l.time=Date.now();var v=t;for(var f in v.requestAnimationFrame=v.requestAnimationFrame||v.webkitRequestAnimationFrame||v.mozRequestAnimationFrame||v.oRequestAnimationFrame||v.msRequestAnimationFrame,v.requestAnimationFrame(function t(i){var e=Date.now();l.time=e,l.update(),v.requestAnimationFrame(t)}),l.tListType={mousedown:"onTouchDown",mouseup:"onTouchUp",mouseout:"onTouchOut",mousemove:"onTouchMove",touchstart:"onTouchDown",touchend:"onTouchUp",touchcancel:"onTouchOut",touchmove:"onTouchMove"},l.tListType)l.canvas.addEventListener(f,y)}else console.error("webgl Not Supported!");function y(t){if(t.changedTouches)for(var i=t.changedTouches,e=0;e<i.length;e++){var s=i[e];s.type=t.type,l.tList.push(s)}else l.tList.push(t)}}createIndexBuffer(t){t>16384&&(t=16384);for(var i=new ArrayBuffer(2*t*6),e=new Uint16Array(i),s=0;s<t;s++){var r=6*s,a=4*s;e[r++]=a,e[r++]=a+1,e[r++]=a+2,e[r++]=a+2,e[r++]=a+1,e[r++]=a+3}var h=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,h),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,e,this.gl.STATIC_DRAW),h}createAttachShader(t,i){var e=this.gl.createShader(t);if(this.gl.shaderSource(e,i),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS))return e;this.debug&&console.log(this.gl.getShaderInfoLog(e)),this.gl.deleteShader(e)}createProgram(t,i){var e=this.createAttachShader(this.gl.VERTEX_SHADER,t),s=this.createAttachShader(this.gl.FRAGMENT_SHADER,i),r=this.gl.createProgram();if(this.gl.attachShader(r,e),this.gl.attachShader(r,s),this.gl.linkProgram(r),this.gl.getProgramParameter(r,this.gl.LINK_STATUS))return r;this.debug&&console.log(this.gl.getProgramInfoLog(r)),this.gl.deleteProgram(r)}uploadTexture(t){var i=this.gl,e=i.createTexture();return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.bindTexture(i.TEXTURE_2D,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e}onTouch(){for(var t=this.tList.length,i=0;i<t;i++){var e=this.tList[i],s=e.identifier||0,r=e.pageX||e.clientX,a=e.pageY||e.clientY;this.alignC&&(r-=this.width>>1,a-=this.height>>1),this.touchEvent(this.root,r,a,s,this.tListType[e.type])}this.tList.length=0}touchEvent(t,i,e,a,n){var o=h.get(s),l=(h.get(r),t.displayList),u=t.displayNum;if(o.x=i,o.y=e,t.fromParentPoint(o),0==t.visible&&0==t.touchEnabled)return!1;for(var d=u-1;d>=0;d--){var m=l[d];if(this.touchEvent(m,o.x,o.y,a,n))break}return o.x>=0&&o.x<=t.width&&o.y>=0&&o.y<=t.height&&t[n]?(t[n].call(t,i,e,a),!0):void 0}update(){this.onTouch(),l.m_loop(),this.resetRender(),this.gl.clearColor(this.G_r,this.G_g,this.G_b,this.G_a),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.transform(this.root,this.root.alpha,this.root.matrix),this.randerList.push([this.drawNum,this.drawStart,this.G_texture,this.G_NBlendMode,this.G_alpha]),this.drawNum=0;var t=this.positionBuffer;null==t&&(this.positionBuffer=t=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.posionList,this.gl.STATIC_DRAW),this.spriteAProgram.bind(),this.spriteAProgram.uploadAttrib(0,4,this.gl.FLOAT),this.spriteProgram.bind(),this.spriteProgram.uploadAttrib(0,4,this.gl.FLOAT),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var i=0;i<this.randerList.length;i++)this.render(this.randerList[i])}transform(t,i,e){for(var s=this.posionList,a=t.displayList,n=t.displayNum,o=(i=t.alpha*i,0);o<n;o++){var l=a[o],u=l.alpha*i,d=l.matrix,m=h.get(r);if(m.set(e.a*d.a+e.c*d.b,e.b*d.a+e.d*d.b,e.a*d.c+e.c*d.d,e.b*d.c+e.d*d.d,e.tx+e.a*d.tx+e.c*d.ty,e.ty+e.b*d.tx+e.d*d.ty),l.visible&&0!==u)if(l.displayList)this.transform(l,u,m);else if(l.m_texture){(null!=this.G_texture&&this.G_texture!=l.m_texture.tex||null!=this.G_blendMode&&l.blendMode!=this.G_blendMode||u!=this.G_alpha)&&(this.randerList.push([this.drawNum,this.drawStart,this.G_texture,this.G_NBlendMode,this.G_alpha]),this.drawStart=12*o,this.drawNum=0),this.G_texture=l.m_texture.tex,this.G_NBlendMode=l.blendMode,this.G_alpha=u;var c=l.width,p=l.height,_=m.tx,g=m.ty,x=m.a*c,v=m.b*c,f=m.c*p,y=m.d*p;s[this.index++]=_,s[this.index++]=g,s[this.index++]=l.m_texture.uv[0],s[this.index++]=l.m_texture.uv[1],s[this.index++]=_+x,s[this.index++]=g+v,s[this.index++]=l.m_texture.uv[2],s[this.index++]=l.m_texture.uv[3],s[this.index++]=_+f,s[this.index++]=g+y,s[this.index++]=l.m_texture.uv[4],s[this.index++]=l.m_texture.uv[5],s[this.index++]=_+x+f,s[this.index++]=g+v+y,s[this.index++]=l.m_texture.uv[6],s[this.index++]=l.m_texture.uv[7],this.drawNum+=6}h.set(r,m)}}resetRender(){this.randerList.length=0,this.G_texture=null,this.G_program=null,this.G_alpha=1,this.batch=0,this.drawNum=0,this.drawStart=0,this.index=0}render(t){if(0!=t[0]){this.G_alpha=t[4],this.G_texture=t[2],this.G_blendMode!=t[3]&&(this.G_blendMode=t[3],this.gl.enable(this.gl.BLEND),u["b"+this.G_blendMode](this.gl));var i=1!=this.G_alpha?this.spriteAProgram:this.spriteProgram;i.bind(),i.uploadUniform1f(1,this.G_alpha),this.gl.bindTexture(this.gl.TEXTURE_2D,this.G_texture),this.gl.drawElements(this.gl.TRIANGLES,t[0],this.gl.UNSIGNED_SHORT,t[1]),this.batch++}}},"BYGL");class s{constructor(t=0,i=0){this.x=t,this.y=i}setTo(t,i){this.x=t,this.y=i}}i.registerClass(s,"Point");class r{constructor(){this.i()}set(t=1,i=0,e=0,s=1,r=0,a=0){this.a=t,this.b=i,this.c=e,this.d=s,this.tx=r,this.ty=a}i(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}t(t,i){this.tx+=t,this.ty+=i}r(t){var i=a.cos[t],e=a.sin[t];this.a*=i,this.b*=-e,this.c*=e,this.d*=i}s(t,i){this.a*=t,this.b*=t,this.c*=i,this.d*=i,this.tx*=t,this.ty*=i}invert(){var t=this.a,i=this.b,e=this.c,s=this.d,r=this.tx,a=t*s-i*e;return this.a=s/a,this.b=-i/a,this.c=-e/a,this.d=t/a,this.tx=(e*this.ty-s*r)/a,this.ty=-(t*this.ty-i*r)/a,this}}i.registerClass(r,"Matrix");class a{static random(t,i){return(Math.random()*(i-t)|0)+t}}a.cos={},a.sin={},i.registerClass(a,"Maths");class h{static get(t){var i=t.__class,e=(h.dr[i]||(h.dr[i]=[])).shift();return null==e?new t:e}static set(t,i){var e=t.__class;(h.dr[e]||(h.dr[e]=[])).push(i)}}h.dr={},i.registerClass(h,"Pool");class n{run(){if(null!=this.callback){var t=null;return t=arguments.length?this.callback.apply(this.pointer,this.args?this.args.concat(arguments):arguments):this.callback.apply(this.pointer,this.args),this.one&&this.free(!0),t}}free(t=!1){this.args=this.callback=this.pointer=null,t&&h.set(n,this)}static create(t,i,e,s=!0){var r=h.get(n);return r.pointer=t,r.callback=i,r.args=e,r.one=s,r}}i.registerClass(n,"Handler");class o{constructor(){this.arr=[],this.num=0}free(){delete l.updateDir[this.pointer.BadyooLoopIdx],this.pointer.BadyooLoopIdx=null,this.pointer=null,this.num=0,this.arr.length=0,h.set(o,this)}}i.registerClass(o,"LoopData");class l{static update(t,i){var e;null==t.BadyooLoopIdx&&((e=h.get(o)).pointer=t,t.BadyooLoopIdx=l.loopIdx++,l.updateDir[t.BadyooLoopIdx]=l.updateList[l.updateNum]=e,l.updateNum++),-1==(e=l.updateDir[t.BadyooLoopIdx]).arr.indexOf(i)&&(e.arr.push(i),e.num++)}static m_loop(){for(var t=0;t<l.updateNum;t++){var i=l.updateList[t],e=i.arr.length;if(0!=i.num)for(var s=0;s<e;s++)0==i.arr[s]?(i.arr.splice(s,1),e--,s--):i.arr[s].call(i.pointer);else i.free(),l.updateList.splice(t,1),l.updateNum--,t--}}static clearUpdate(t,i){if(null!=t.BadyooLoopIdx){var e=l.updateDir[t.BadyooLoopIdx],s=e.arr.indexOf(i);-1!=s&&(e.arr.splice(s,1,0),e.num--)}}static clearAll(t){if(null!=t.BadyooLoopIdx){var i=l.updateDir[t.BadyooLoopIdx],e=l.updateList.indexOf(i);-1!=e&&(i.free(),l.updateList.splice(e,1),l.updateNum--)}}}l.loopIdx=0,l.updateList=[],l.updateDir={},l.updateNum=0,i.registerClass(l,"Loop");class u{static b0(t){t.blendFunc(t.ONE,t.ZERO)}static b1(t){t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}static b2(t){t.blendFunc(t.ONE,t.DST_ALPHA)}static b3(t){t.blendFunc(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA)}static b4(t){t.blendFunc(t.ONE,t.ONE)}static b5(t){t.blendFunc(t.ZERO,t.ZERO)}}u.NONE=0,u.NORMAL=1,u.ADD=2,u.MULTIPLY=3,u.SCREEN=4,u.ERASE=5,i.registerClass(u,"BlendMode");class d{constructor(){this.m_x=0,this.m_y=0,this.width=0,this.height=0,this.alpha=1,this.m_pivotX=0,this.m_pivotY=0,this.m_rotation=0,this.m_scaleX=1,this.m_scaleY=1,this.visible=!0,this.blendMode=u.NORMAL,this.parent=null,this.m_matrix=h.get(r),this.touchEnabled=!1,this.m_matrixChange=!1}get x(){return this.m_x}set x(t){this.m_x!=t&&(this.m_x=t,this.m_matrixChange=!0)}get y(){return this.m_y}set y(t){this.m_y!=t&&(this.m_y=t,this.m_matrixChange=!0)}get pivotX(){return this.m_pivotX}set pivotX(t){this.m_pivotX!=t&&(this.m_pivotX=t,this.m_matrixChange=!0)}get pivotY(){return this.m_pivotY}set pivotY(t){this.m_pivotY!=t&&(this.m_pivotY=t,this.m_matrixChange=!0)}get scaleX(){return this.m_scaleX}set scaleX(t){this.m_scaleX!=t&&(this.m_scaleX=t,this.m_matrixChange=!0)}get scaleY(){return this.m_scaleY}set scaleY(t){this.m_scaleY!=t&&(this.m_scaleY=t,this.m_matrixChange=!0)}set rotation(t){this.m_rotation!=t&&(this.m_rotation=t,this.m_matrixChange=!0)}get rotation(){return this.m_rotation}get matrix(){return this.m_matrixChange&&this.updateMatrix(),this.m_matrix}set matrix(t){this.m_matrix=t}pivot(t,i){this.m_pivotX==t&&this.m_pivotY==i||(this.m_pivotX=t,this.m_pivotY=i,this.m_matrixChange=!0)}scale(t,i){this.m_scaleX==t&&this.m_scaleY==i||(this.m_scaleX=t,this.m_scaleY=i,this.m_matrixChange=!0)}updateMatrix(){var t=this.m_rotation;if(0==t)this.m_matrix.set(this.m_scaleX,0,0,this.m_scaleY,this.m_x-this.m_scaleX*this.m_pivotX,this.m_y-this.m_scaleY*this.m_pivotY);else{(t%=360)<0&&(t+=360);var i=a.cos[t],e=a.sin[t];this.m_matrix.a=this.m_scaleX*i,this.m_matrix.b=this.m_scaleX*e,this.m_matrix.c=this.m_scaleY*-e,this.m_matrix.d=this.m_scaleY*i,this.m_matrix.tx=this.m_x-this.m_pivotX*this.m_matrix.a-this.m_pivotY*this.m_matrix.c,this.m_matrix.ty=this.m_y-this.m_pivotX*this.m_matrix.b-this.m_pivotY*this.m_matrix.d}}toParentPoint(t){var i=this.matrix,e=i.a*t.x+i.c*t.y+i.tx,s=i.b*t.x+i.d*t.y+i.ty;return t.x=e,t.y=s,t}fromParentPoint(t){var i=this.matrix,e=h.get(r);e.set(i.a,i.b,i.c,i.d,i.tx,i.ty),e.invert();var s=e.a*t.x+e.c*t.y+e.tx,a=e.b*t.x+e.d*t.y+e.ty;return t.x=s,t.y=a,t}localToGlobal(t,e=!1,r=null){!0===e&&(t=h.get(s).setTo(t.x,t.y));var a=this;for(r=r||i.current.root;a&&a!=r;)t=a.toParentPoint(t),a=a.parent;return t}globalToLocal(t,e=!1,r=null){!0===e&&(t=h.get(s).setTo(t.x,t.y));var a=this;r=r||i.current.root;for(var n=[];a&&a!=r;)n.push(a),a=a.parent;for(var o=n.length-1;o>=0;)t=(a=n[o]).fromParentPoint(t),o--;return t}hitTest(t){return 0!=this.width&&0!=this.height&&(t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.x<=this.y+this.height)}move(t,i){this.x=t,this.y=i}updateTouchEnabled(){this.touchEnabled=this.m_onTouchMove||this.m_onTouchDown||this.m_onTouchUp||this.m_onTouchOut}get onTouchDown(){return this.m_onTouchDown}set onTouchDown(t){this.m_onTouchDown=t,this.updateTouchEnabled()}get onTouchMove(){return this.m_onTouchMove}set onTouchMove(t){this.m_onTouchMove=t,this.updateTouchEnabled()}get onTouchUp(){return this.m_onTouchUp}set onTouchUp(t){this.m_onTouchUp=t,this.updateTouchEnabled()}get onTouchOut(){return this.m_onTouchOut}set onTouchOut(t){this.m_onTouchOut=t,this.updateTouchEnabled()}free(){this.parent&&this.parent.removeChild(this)}}i.registerClass(d,"GameObject");class m{constructor(){this.url="",this.type="",this.handler=null}load(i,e){var s=this;s.type="image",s.url=i,s.handler=e;var r=new t.Image;r.src=this.url,r.crossOrigin="",r.onload=function(){r.onerror=r.onload=null,s.onloaded(r)},r.onerror=function(){r.onerror=r.onload=null,s.onloaded(null)}}httpRequet(t,i,e,s="get",r="text"){var a=this;a.type="httpRequet",a.url=i,a.handler=e;var h=new XMLHttpRequest;h.open(s,i,!0),h.responseType=r,h.setRequestHeader("Content-Type","application/json"),null!=t&&"string"!=typeof t||h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),"arraybuffer"!==(r="arraybuffer")&&(r="text"),h.dataType&&(h.dataType=r),h.onerror=function(t){h.onerror=h.onload=h.onabort=null,a.onloaded(h)},h.onabort=function(t){h.onerror=h.onload=h.onabort=null,a.onloaded(h)},h.onload=function(t){h.onerror=h.onload=h.onabort=null,a.onloaded(h)},h.send(t)}onloaded(t){if(t){if("image"==this.type){var i=new c(t);i.url=this.url,m.assets[this.url]=i}else{var e=t,s=void 0!==e.status?e.status:200;200===s||204===s||0===s?m.assets[this.url]=e.response||e.responseText:console.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}if("atlas"==this.type)return void this.parse(m.assets[this.url]);this.onLoadCall()}else console.log("load error url:"+this.url)}parse(t){var i=m.assets[this.url]=JSON.parse(t);i.meta&&i.meta.image&&m.load(i.meta.image,n.create(this,this.parseDone))}parseDone(t){var i=m.assets[this.url],e=this.url.split(".")[0];for(var s in i.frames){var r=i.frames[s],a=new c(t),h=r.frame.x/a.width,n=r.frame.y/a.height,o=h+r.frame.w/a.width,l=n+r.frame.h/a.height;r.rotated?(a.uv[0]=o,a.uv[1]=n,a.uv[2]=o,a.uv[3]=l,a.uv[4]=h,a.uv[5]=n,a.uv[6]=h,a.uv[7]=l):(a.uv[0]=h,a.uv[1]=n,a.uv[2]=o,a.uv[3]=n,a.uv[4]=h,a.uv[5]=l,a.uv[6]=o,a.uv[7]=l),a.url=e+"/"+s,a.width=r.sourceSize.w,a.height=r.sourceSize.h,c.atlas[a.url]=a}this.onLoadCall()}onLoadCall(){if(null!=this.handler.length){for(var t=this.handler.length,i=0;i<t;i++)this.handler[i].run(m.assets[this.url]);this.handler.length=0}else this.handler.run(m.assets[this.url]);this.handler=null,this.url="",this.type="",h.set(m,this),delete m.pool[this.url]}static load(t,i,e){if(c.atlas[t])i.run(c.atlas[t]);else if(m.assets[t])i.run(m.assets[t]);else{var s=m.pool[t];s?s.handler instanceof Array?s.handler.push(i):s.handler=[s.handler,i]:(s=m.pool[t]=h.get(m),t.lastIndexOf(".json")>-1?s.httpRequet(null,t,i):s.load(t,i),null!=e&&(s.type=e))}}static getRES(t){return m.pool[t]}}m.pool={},m.assets={},i.registerClass(m,"Loader");class c{constructor(t){this.width=t.width,this.height=t.height,this.uv=[0,0,1,0,0,1,1,1],this.tex=t instanceof c==0?i.current.uploadTexture(t):t.tex}}c.atlas={},i.registerClass(c,"Texture");class p extends d{constructor(){super(),this.displayList=[],this.displayNum=0,this.touchEnabled=!0}Instantiate(t){var i=new t;return i instanceof d&&this.addChild(i),i}get numChildren(){return this.displayNum}contains(t){return-1!=this.displayList.indexOf(t)}addChild(t){this.addChildAt(t,this.displayNum)}addChildAt(t,i){if(!(i>=0&&i<=this.displayNum))throw new RangeError("Invalid child index");t.parent==this?this.setChildIndex(t,i):i==this.displayNum?this.displayList[this.displayNum++]=t:this.displayList.splice(i,0,t),t.parent=this}removeChild(t){var i=this.displayList.indexOf(t);-1!=i&&(this.displayList.splice(i,1),this.displayNum--,t.parent=null)}removeChildAt(t){if(t>=0&&t<this.displayNum){var i=this.displayList[t];this.displayList.splice(t,1),this.displayNum--,i.parent=null}}removeAllChild(t=0,i=-1){(i<0||i>=this.displayNum)&&(i=this.displayNum-1);for(var e=t;e<=i;e++)this.removeChildAt(t)}getChildAt(t){if(t>=0&&t<this.displayNum)return this.displayList[t];throw new Error("Invalid child index")}getChildByName(t){for(var i=0;i<this.displayNum;i++)if(this.displayList[i].name==t)return this.displayList[i];return null}getChildIndex(t){return this.displayList.indexOf(t)}setChildIndex(t,i){var e=this.displayList.indexOf(t);if(e!=i){if(-1==e)throw new Error("Not a child of this layer");this.displayList.splice(e,1),this.displayList.splice(i,0,t)}}}i.registerClass(p,"Layer");class _ extends d{constructor(){super()}set skin(t){this.m_skin=t,m.load(this.m_skin,n.create(this,this.skinLoaded))}get skin(){return this.m_skin}skinLoaded(t){t.url==this.m_skin&&(this.texture=t)}set texture(t){this.m_texture=t}get texture(){return this.m_texture}get width(){return this.m_width||this.m_texture&&this.m_texture.width}set width(t){this.m_width=t}get height(){return this.m_height||this.m_texture&&this.m_texture.height}set height(t){this.m_height=t}}i.registerClass(_,"Image");i.registerClass(class extends _{constructor(){super(),this.fps=30,this.currentFrame=0,this.totalframes=0,this.currentAnimation=""}set skin(t){this.m_skin=t,m.load(this.m_skin,n.create(this,this.skinLoaded),"atlas")}get skin(){return this.m_skin}skinLoaded(t){this.texture=t}play(t){this.currentAnimation=t}stop(){}gotoAndStop(t){}gotoAndPlay(t){}},"Sprite");i.registerClass(class extends d{constructor(){super(),this.m_text="",this.m_spacing=0,this.m_lineHeight=0,this.m_spaceWidth=0,this.m_skin=""}get skin(){return this.m_skin}set skin(t){this.m_skin=t,m.load(this.m_skin,n.create(this,this.skinLoaded))}skinLoaded(t){t.url==this.m_skin&&(this.texture=t)}get text(){return this.m_text}set text(t){this.m_text=t}get spacing(){return this.m_spacing}set spacing(t){this.m_spacing=t}get lineHeight(){return this.m_lineHeight}set lineHeight(t){this.m_lineHeight=t}get spaceWidth(){return this.m_spaceWidth}set spaceWidth(t){this.m_spaceWidth=t}},"SpriteFont");class g{static playSound(t,i){g.soundPool[t]=new Audio(t).play()}static stopSound(t){}static playMusic(t,i=-1){var e=new Audio(t);e.loop=-1==i,e.play(),g.musicPool[t]=e}static stopMusic(t){}}g.soundPool={},g.musicPool={},i.registerClass(g,"SoundMgr"),i.current=new i.BYGL,i.power=function(t,e,s=!0,r=null,a=null){i.current.init(t,e,a,s,r)},i.bgColor=function(t){i.current.G_a=(t>>24&255)/255,i.current.G_r=(t>>16&255)/255,i.current.G_g=(t>>8&255)/255,i.current.G_b=(255&t)/255},i.Instantiate=function(t){var e=new t;return e instanceof d&&i.current.root.addChild(e),e}}(window);